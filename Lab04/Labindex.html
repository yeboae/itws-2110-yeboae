<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Troy Weather & News Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
        }
        .weather-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }
        .weather-main {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .temp-display {
            font-size: 4rem;
            font-weight: bold;
            color: #667eea;
        }
        .weather-icon {
            font-size: 5rem;
        }
        .weather-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .detail-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        .detail-item i {
            color: #667eea;
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        .news-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        .news-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        .news-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        .btn-location {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 500;
        }
        .btn-location:hover {
            opacity: 0.9;
            color: white;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 1.2rem;
        }
        .section-title {
            color: white;
            font-size: 2rem;
            font-weight: bold;
            margin: 30px 0 20px 0;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="text-center mb-4">
            <h1 class="text-white display-4 fw-bold">Weather & News Dashboard</h1>
            <button class="btn btn-location mt-3" onclick="getUserLocation()">
                <i class="fas fa-location-crosshairs me-2"></i>Use My Location
            </button>
        </div>

        <div id="loading" class="loading">
            <i class="fas fa-spinner fa-spin fa-3x"></i>
            <p>Loading data...</p>
        </div>

        <div id="error" class="error-message" style="display: none;"></div>

        <div id="weatherSection" style="display: none;">
            <div class="weather-card">
                <div class="weather-main">
                    <div>
                        <h2 id="cityName">Troy, NY</h2>
                        <p id="weatherDescription" class="text-muted fs-5"></p>
                        <div class="temp-display" id="temperature"></div>
                    </div>
                    <div class="weather-icon" id="weatherIcon"></div>
                </div>
                <div class="weather-details">
                    <div class="detail-item">
                        <i class="fas fa-temperature-high"></i>
                        <p class="mb-0 fw-bold" id="feelsLike"></p>
                        <small class="text-muted">Feels Like</small>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-tint"></i>
                        <p class="mb-0 fw-bold" id="humidity"></p>
                        <small class="text-muted">Humidity</small>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-wind"></i>
                        <p class="mb-0 fw-bold" id="windSpeed"></p>
                        <small class="text-muted">Wind Speed</small>
                    </div>
                    <div class="detail-item">
                        <i class="fas fa-gauge"></i>
                        <p class="mb-0 fw-bold" id="pressure"></p>
                        <small class="text-muted">Pressure</small>
                    </div>
                </div>
            </div>
        </div>

        <h2 class="section-title" id="newsTitle" style="display: none;">
            <i class="fas fa-newspaper me-2"></i>Latest News
        </h2>
        <div id="newsSection" class="row"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const WEATHER_API_KEY = 'e49c6326c052ca6388d8bebdeb5bf9a2';
        const NEWS_API_KEY = 'YOUR_NEWS_API_KEY';
        let currentCity = 'Troy,NY,US';

        function getWeatherIcon(code) {
            const iconMap = {
                '01d': '☀️', '01n': '🌙',
                '02d': '⛅', '02n': '☁️',
                '03d': '☁️', '03n': '☁️',
                '04d': '☁️', '04n': '☁️',
                '09d': '🌧️', '09n': '🌧️',
                '10d': '🌦️', '10n': '🌧️',
                '11d': '⛈️', '11n': '⛈️',
                '13d': '❄️', '13n': '❄️',
                '50d': '🌫️', '50n': '🌫️'
            };
            return iconMap[code] || '🌤️';
        }

        async function fetchWeather(lat = null, lon = null) {
            try {
                let url;
                if (lat && lon) {
                    url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=imperial&appid=${WEATHER_API_KEY}`;
                } else {
                    url = `https://api.openweathermap.org/data/2.5/weather?q=${currentCity}&units=imperial&appid=${WEATHER_API_KEY}`;
                }

                const response = await fetch(url);
                if (!response.ok) throw new Error('Weather data not available');
                
                const data = await response.json();
                displayWeather(data);
            } catch (error) {
                showError('Unable to fetch weather data: ' + error.message);
            }
        }

        function displayWeather(data) {
            document.getElementById('cityName').textContent = `${data.name}, ${data.sys.country}`;
            document.getElementById('weatherDescription').textContent = 
                data.weather[0].description.charAt(0).toUpperCase() + 
                data.weather[0].description.slice(1);
            document.getElementById('temperature').textContent = `${Math.round(data.main.temp)}°F`;
            document.getElementById('weatherIcon').textContent = getWeatherIcon(data.weather[0].icon);
            document.getElementById('feelsLike').textContent = `${Math.round(data.main.feels_like)}°F`;
            document.getElementById('humidity').textContent = `${data.main.humidity}%`;
            document.getElementById('windSpeed').textContent = `${Math.round(data.wind.speed)} mph`;
            document.getElementById('pressure').textContent = `${data.main.pressure} hPa`;
            
            document.getElementById('weatherSection').style.display = 'block';
        }

        async function fetchNews() {
            try {
                const response = await fetch(
                    `https://newsapi.org/v2/top-headlines?country=us&pageSize=6&apiKey=${NEWS_API_KEY}`
                );
                
                if (!response.ok) throw new Error('News data not available');
                
                const data = await response.json();
                displayNews(data.articles);
            } catch (error) {
                showError('Unable to fetch news: ' + error.message);
            }
        }

        function displayNews(articles) {
            const newsSection = document.getElementById('newsSection');
            newsSection.innerHTML = '';
            
            articles.forEach(article => {
                if (article.title && article.title !== '[Removed]') {
                    const col = document.createElement('div');
                    col.className = 'col-md-6 col-lg-4';
                    col.innerHTML = `
                        <div class="news-card">
                            ${article.urlToImage ? 
                                `<img src="${article.urlToImage}" class="news-image" alt="News image">` : 
                                '<div class="news-image bg-secondary d-flex align-items-center justify-content-center"><i class="fas fa-newspaper fa-3x text-white"></i></div>'
                            }
                            <h5>${article.title}</h5>
                            <p class="text-muted small">${article.description || 'No description available'}</p>
                            <a href="${article.url}" target="_blank" class="btn btn-sm btn-outline-primary">Read More</a>
                        </div>
                    `;
                    newsSection.appendChild(col);
                }
            });
            
            document.getElementById('newsTitle').style.display = 'block';
        }

        function getUserLocation() {
            if (navigator.geolocation) {
                document.getElementById('loading').style.display = 'block';
                navigator.geolocation.getCurrentPosition(
                    position => {
                        fetchWeather(position.coords.latitude, position.coords.longitude);
                        document.getElementById('loading').style.display = 'none';
                    },
                    error => {
                        showError('Unable to get your location. Showing Troy, NY weather.');
                        fetchWeather();
                        document.getElementById('loading').style.display = 'none';
                    }
                );
            } else {
                showError('Geolocation is not supported by your browser.');
                fetchWeather();
            }
        }

        function showError(message) {
            const errorDiv = document.getElementById('error');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        async function initApp() {
            await fetchWeather();
            await fetchNews();
            document.getElementById('loading').style.display = 'none';
        }

        window.onload = initApp;
    </script>
</body>
</html>